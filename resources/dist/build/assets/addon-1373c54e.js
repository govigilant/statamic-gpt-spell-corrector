var O=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function z(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var S={exports:{}};(function(c,r){(function(n,i){c.exports=i()})(O,function(){var n="__v-click-outside",i=typeof window<"u",v=typeof navigator<"u",_=i&&("ontouchstart"in window||v&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"];function h(t){var a=t.event,e=t.handler;(0,t.middleware)(a)&&e(a)}function p(t,a){var e=function(s){var l=typeof s=="function";if(!l&&typeof s!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:l?s:s.handler,middleware:s.middleware||function(u){return u},events:s.events||_,isActive:s.isActive!==!1,detectIframe:s.detectIframe!==!1,capture:!!s.capture}}(a.value),f=e.handler,m=e.middleware,T=e.detectIframe,C=e.capture;if(e.isActive){if(t[n]=e.events.map(function(s){return{event:s,srcTarget:document.documentElement,handler:function(l){return function(u){var g=u.el,w=u.event,k=u.handler,b=u.middleware,y=w.composedPath&&w.composedPath()||w.path;(y?y.indexOf(g)<0:!g.contains(w.target))&&h({event:w,handler:k,middleware:b})}({el:t,event:l,handler:f,middleware:m})},capture:C}}),T){var E={event:"blur",srcTarget:window,handler:function(s){return function(l){var u=l.el,g=l.event,w=l.handler,k=l.middleware;setTimeout(function(){var b=document.activeElement;b&&b.tagName==="IFRAME"&&!u.contains(b)&&h({event:g,handler:w,middleware:k})},0)}({el:t,event:s,handler:f,middleware:m})},capture:C};t[n]=[].concat(t[n],[E])}t[n].forEach(function(s){var l=s.event,u=s.srcTarget,g=s.handler;return setTimeout(function(){t[n]&&u.addEventListener(l,g,C)},0)})}}function o(t){(t[n]||[]).forEach(function(a){return a.srcTarget.removeEventListener(a.event,a.handler,a.capture)}),delete t[n]}var d=i?{bind:p,update:function(t,a){var e=a.value,f=a.oldValue;JSON.stringify(e)!==JSON.stringify(f)&&(o(t),p(t,{value:e}))},unbind:o}:{};return{install:function(t){t.directive("click-outside",d)},directive:d}})})(S);var R=S.exports;const D=z(R);function N(c,r,n,i,v,_,h,p){var o=typeof c=="function"?c.options:c;r&&(o.render=r,o.staticRenderFns=n,o._compiled=!0),i&&(o.functional=!0),_&&(o._scopeId="data-v-"+_);var d;if(h?(d=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!e&&typeof __VUE_SSR_CONTEXT__<"u"&&(e=__VUE_SSR_CONTEXT__),v&&v.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(h)},o._ssrRegister=d):v&&(d=p?function(){v.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:v),d)if(o.functional){o._injectStyles=d;var t=o.render;o.render=function(f,m){return d.call(m),t(f,m)}}else{var a=o.beforeCreate;o.beforeCreate=a?[].concat(a,d):[d]}return{exports:c,options:o}}const x={name:"Spell Corrector",directives:{clickOutside:D.directive},mixins:[BardToolbarButton],data(){return{showDropdown:!1,promptText:"",type:"full",charactersReceived:0,status:""}},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown},async send(){var c,r,n;this.editor.setEditable(!1),this.charactersReceived=0;try{this.status="Correcting (0 chars)";const i=await fetch("/cp/vigilant/correct-spelling",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":StatamicConfig.csrfToken},body:JSON.stringify({bard:this.editor.getJSON()})});if(!i.ok){Statamic.$toast.error(((c=i==null?void 0:i.data)==null?void 0:c.message)||__("Something went wrong."),{duration:1e4}),this.editor.commands.focus(),this.editor.setEditable(!0),this.status="Error";return}const v=i.body.getReader(),_=new TextDecoder;let h=!1,p="";for(;!h;){const{value:e,done:f}=await v.read();if(h=f,e){const m=_.decode(e,{stream:!0});this.charactersReceived+=m.length,p+=m,this.status="Correcting ("+this.charactersReceived+" chars)"}}const o=p.match(/```json(.*?)```/s)[1],t=new DOMParser().parseFromString(o,"text/html").documentElement.textContent;let a;try{a=JSON.parse(t),this.editor.commands.setContent(a),this.status="Finished! Check result in the editor."}catch(e){Statamic.$toast.error(__("Failed to parse response"),{duration:1e4}),console.error("Error parsing JSON:",e)}}catch(i){Statamic.$toast.error(((n=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:n.message)||i.message||__("Something went wrong."),{duration:1e4}),this.status="Error"}finally{this.editor.commands.focus(),this.editor.setEditable(!0)}}}};var $=function(){var r=this,n=r._self._c;return n("div",{staticClass:"inline-block relative"},[n("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:r.button.text,expression:"button.text"}],staticClass:"bard-toolbar-button",domProps:{innerHTML:r._s(r.button.html)},on:{click:r.toggleDropdown}}),r.showDropdown?n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:r.toggleDropdown,expression:"toggleDropdown"}],staticClass:"absolute popover-content p-4 bg-white dark:bg-dark-550 shadow-popover dark:shadow-dark-popover rounded-md"},[n("div",{staticClass:"block mb-2"},[n("button",{staticClass:"btn-primary",on:{click:r.send}},[r._v("Correct spelling")]),n("p",{staticClass:"text-xs text-black dark:text-white mt-2"},[r._v(r._s(r.status))])])]):r._e()])},j=[],F=N(x,$,j,!1,null,null,null,null);const P=F.exports;Statamic.$bard.buttons(()=>({name:"spellcorrector",text:__("Spell Corrector"),html:'<svg viewBox="0 0 64 64"><path fill="currentColor" d="m9.8 19.2c0-4.2-1.8-5.5-4.6-6-1.8-0.4-2.2-1.1-2.2-3.4 0-2.3 1.4-3.2 2.8-3.2 1 0 2.4 0.2 3.4 0.4v-2.1c-0.9-0.2-2.1-0.4-3.1-0.4-3.3 0-5.7 1.4-5.7 5.6 0 3.4 1.2 4.8 4.4 5.5 1.6 0.3 2.4 1.1 2.4 3.9 0 2.4-0.9 3.6-2.9 3.6-1.6 0-2.7-0.2-3.6-0.4v2.1c0.9 0.2 2.4 0.4 3.3 0.4 3.5 0 5.8-1.2 5.8-6zm12-8.2c0 3.2-1.2 4.2-2.8 4.2h-2.7v-8.4c0 0 1.1-0.2 2.7-0.2 2.1 0 2.8 1.5 2.8 4.4zm2.5-0.2c0-3.6-1.2-6.3-5.6-6.3-2.4 0-4.9 0.2-4.9 0.2v20.3h2.5v-7.7h2.4c4.1 0 5.6-2.1 5.6-6.5zm13.5 14.2v-2.1h-7v-7.3h6.2v-2.1h-6.2v-6.7h7v-2.1h-9.5v20.3zm13.2 0v-2.2h-6.5v-18.1h-2.5v20.3zm11.9 0v-2.2h-6.5v-18.1h-2.5v20.3zm-49.7 31.6c-0.7 0.2-2.1 0.4-3.3 0.4-2.1 0-3.2-1-3.2-8.3 0-7 1-8 3.2-8 1.1 0 2.4 0.1 3.3 0.3v-2.1c-0.7-0.2-1.9-0.4-2.8-0.4-4.3 0-6.2 1.5-6.2 10 0 8.7 1.7 10.7 5.8 10.7 1 0 2.6-0.3 3.2-0.5zm12.2-7.8c0 6.2-0.9 8.3-3.5 8.3-2.6 0-3.5-2.1-3.5-8.3 0-6.4 0.9-8.2 3.5-8.2 2.6 0 3.5 1.8 3.5 8.2zm2.6-0.2c0-6.8-1.3-10.1-6.1-10.1-4.8 0-6 3.3-6 10.1 0 7.1 1.2 10.6 6 10.6 4.8 0 6.1-3.5 6.1-10.6zm14.9-4.2c0-3.5-1.3-5.9-5.7-5.9-2.4 0-4.9 0.2-4.9 0.2v20.3h2.6v-8.4h2.5l3.7 8.4h2.8l-3.9-8.8c2-0.8 2.9-2.8 2.9-5.8zm-2.6 0.2c0 3.2-1.1 3.9-2.7 3.9h-2.7v-7.7c0 0 1.1-0.2 2.7-0.2 2 0 2.7 1.2 2.7 4zm17.5-0.2c0-3.5-1.2-5.9-5.6-5.9-2.4 0-4.9 0.2-4.9 0.2v20.3h2.5v-8.4h2.6l3.7 8.4h2.8l-4-8.8c2-0.8 2.9-2.8 2.9-5.8zm-2.6 0.2c0 3.2-1.1 3.9-2.7 3.9h-2.7v-7.7c0 0 1.1-0.2 2.7-0.2 2.1 0 2.7 1.2 2.7 4z"/></svg>',component:P}));
